#include "vmware_dir.h"

/*
Check against VMWare blacklisted directories
*/
void vmware_dir()
{
	TCHAR szProgramFile[MAX_PATH];
	char szPath[MAX_PATH] = "";
	char szTarget[MAX_PATH] = "VMWare\\";

	if (IsWoW64())
		ExpandEnvironmentStrings("%ProgramW6432%", szProgramFile, ARRAYSIZE(szProgramFile));
	else
		SHGetSpecialFolderPath(NULL, szProgramFile, CSIDL_PROGRAM_FILES, FALSE);

	PathCombine(szPath, szProgramFile, szTarget);
	if (is_DirectoryExists(szPath))
		exit(1);
}