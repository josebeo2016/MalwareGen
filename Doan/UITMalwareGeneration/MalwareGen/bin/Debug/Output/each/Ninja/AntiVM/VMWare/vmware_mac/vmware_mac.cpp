#include "vmware_mac.h"


/*
Check VMWare NIC MAC addresses
*/
VOID vmware_mac()
{
	/* VMWre blacklisted mac adr */
	char *szMac[][2] = {
		{"\x00\x05\x69", "00:05:69" }, // VMWare, Inc.
		{"\x00\x0C\x29", "00:0c:29" }, // VMWare, Inc.
		{"\x00\x1C\x14", "00:1C:14" }, // VMWare, Inc.
		{"\x00\x50\x56", "00:50:56" }	// VMWare, Inc.
	};

	WORD dwLength = sizeof(szMac) / sizeof(szMac[0]);

	/* Check one by one */
	for (int i = 0; i < dwLength; i++)
	{
		if (check_mac_addr(szMac[i][0]))
			exit(1);
	}
}

