#include "loaded_dlls.h"


void loaded_dlls()
{
	/* Some vars */
	HMODULE hDll;

	/* Array of strings of blacklisted dlls */
	char* szDlls[] = {
		"avghookx.dll",		// AVG
		"avghooka.dll",		// AVG
		"snxhk.dll",		// Avast
		"sbiedll.dll",		// Sandboxie
		"dbghelp.dll",		// WindBG
		"api_log.dll",		// iDefense Lab
		"dir_watch.dll",	// iDefense Lab
		"pstorec.dll",		// SunBelt Sandbox
		"vmcheck.dll",		// Virtual PC
		"wpespy.dll"		// WPE Pro
	};

	WORD dwlength = sizeof(szDlls) / sizeof(szDlls[0]);
	for (int i = 0; i < dwlength; i++)
	{
		/* Check if process loaded modules contains the blacklisted dll */
		hDll = GetModuleHandle(szDlls[i]);
		if (hDll != NULL)
			exit(1);
	}
}

