#include "AntiAnalysis.h"

void AntiAnalysis()
{
	char *szProcesses[] = {
		("ollydbg.exe"),			// OllyDebug debugger
		("ProcessHacker.exe"),		// Process Hacker
		("tcpview.exe"),			// Part of Sysinternals Suite
		("autoruns.exe"),			// Part of Sysinternals Suite
		("autorunsc.exe"),			// Part of Sysinternals Suite
		("filemon.exe"),			// Part of Sysinternals Suite
		("procmon.exe"),			// Part of Sysinternals Suite
		("regmon.exe"),				// Part of Sysinternals Suite
		("procexp.exe"),			// Part of Sysinternals Suite
		("idaq.exe"),				// IDA Pro Interactive Disassembler
		("idaq64.exe"),				// IDA Pro Interactive Disassembler
		("ImmunityDebugger.exe"),	// ImmunityDebugger
		("Wireshark.exe"),			// Wireshark packet sniffer
		("dumpcap.exe"),			// Network traffic dump tool
		("HookExplorer.exe"),		// Find various types of runtime hooks
		("ImportREC.exe"),			// Import Reconstructor
		("PETools.exe"),			// PE Tool
		("LordPE.exe"),				// LordPE
		("SysInspector.exe"),		// ESET SysInspector
		("proc_analyzer.exe"),		// Part of SysAnalyzer iDefense
		("sysAnalyzer.exe"),		// Part of SysAnalyzer iDefense
		("sniff_hit.exe"),			// Part of SysAnalyzer iDefense
		("windbg.exe"),				// Microsoft WinDbg
		("joeboxcontrol.exe"),		// Part of Joe Sandbox
		("joeboxserver.exe"),		// Part of Joe Sandbox
	};

	WORD iLength = sizeof(szProcesses) / sizeof(szProcesses[0]);
	for (int i = 0; i < iLength; i++)
	{
		if (GetProcessIdFromName(szProcesses[i]))
			exit(1);
	}
}