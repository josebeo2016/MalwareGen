#pragma once
#include "vbox_files.h"



/*
Check against virtualbox blacklisted files
*/
VOID vbox_files()
{
	/* Array of strings of blacklisted paths */
	char* szPaths[] = {
		"system32\\drivers\\VBoxMouse.sys",
		"system32\\drivers\\VBoxGuest.sys",
		"system32\\drivers\\VBoxSF.sys",
		"system32\\drivers\\VBoxVideo.sys",
		"system32\\vboxdisp.dll",
		"system32\\vboxhook.dll",
		"system32\\vboxmrxnp.dll",
		"system32\\vboxogl.dll",
		"system32\\vboxoglarrayspu.dll",
		"system32\\vboxoglcrutil.dll",
		"system32\\vboxoglerrorspu.dll",
		"system32\\vboxoglfeedbackspu.dll",
		"system32\\vboxoglpackspu.dll",
		"system32\\vboxoglpassthroughspu.dll",
		"system32\\vboxservice.exe",
		"system32\\vboxtray.exe",
		"system32\\VBoxControl.exe"
	};

	/* Getting Windows Directory */
	WORD dwlength = sizeof(szPaths) / sizeof(szPaths[0]);
	TCHAR szWinDir[MAX_PATH] = "";
	TCHAR szPath[MAX_PATH] = "";
	GetWindowsDirectory(szWinDir, MAX_PATH);

	/* Check one by one */
	for (int i = 0; i < dwlength; i++)
	{
		PathCombine(szPath, szWinDir, szPaths[i]);
		if (is_FileExists(szPath))
			exit(1);
	}
}



