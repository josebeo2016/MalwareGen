#include "io.h"
#include <stdio.h>

char *ReadFile(const char * file, DWORD &size)
{
	HMODULE hModule = NULL;
	FILE *fFile;
	long lSize;
	char *buf = NULL;
	size_t result;

	fFile = fopen(file, "rb");
	if (fFile)
	{
		fseek(fFile, 0, SEEK_END);
		lSize = ftell(fFile);
		size = lSize;
		rewind(fFile);

		buf = (char*)calloc(lSize, 1);
		if (buf)
		{
			result = fread(buf, 1, lSize, fFile);
			if (result != lSize)
			{
				printf("Reading file failed.");
				free(buf);
				buf = NULL;
				size = 0;
			}
		}
		else
			printf("calloc failed.");
	}
	else
		printf("Can't open file, error %d.", GetLastError());

	return buf;
}

void WriteFile(const char *file, char* buf, DWORD size)
{
	FILE *fo = fopen(file, "wb");
	if (fo)
	{
		fwrite(buf, size, 1, fo);

		fclose(fo);
	}
}