using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Xml;

namespace MalwareGen
{
    public class Modules
    {
        
        public string MName { get; set; }
        public string MType { get; set; }
        //You can define each module as an Child Class of Module. But we
        //had not enough time.
        public string Author { get; set; }
        public string Reference { get; set; }
        public List<string> Files = new List<string>();
        public List<string> Inputs = new List<string>();
        //for debug
        public string spreader = "Base64P2P"; //if this module is exploit
        public string increaseip = "RandomChooseIP_IncreaseIP";

        public string Header { get; set; }
        public string Info { get; set; }
        public string path { get; set; }
        public Modules() { }

        public Modules(string path)
        {           
            this.path = path;
            XmlDocument document = new XmlDocument();
            document.Load(path);
            XmlNodeList nodes = document.DocumentElement.ChildNodes;
            foreach (XmlNode childnode in nodes)
            {
                if (childnode.Name == "Name")
                    this.MName = childnode.InnerText;
                if (childnode.Name == "Type")
                    this.MType = childnode.InnerText;
                if (childnode.Name == "Author")
                    this.Author = childnode.InnerText;
                if (childnode.Name == "Header")
                    this.Header = childnode.InnerText;
                if (childnode.Name == "Files")
                    foreach (XmlNode node in childnode.ChildNodes)
                    {
                        string tmp = node.InnerText;
                        this.Files.Add(tmp);
                    }
                if (childnode.Name == "Inputs")
                    foreach (XmlNode node in childnode.ChildNodes)
                    {
                        string tmp = node.InnerText;
                        this.Inputs.Add(tmp);
                    }
                if (childnode.Name == "Info")
                    this.Info = childnode.InnerText;
                if (childnode.Name == "Reference")
                    this.Reference = childnode.InnerText;
            }
        }
        

    }
}
