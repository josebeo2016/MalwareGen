#include "vbox_dir.h"

/*
Check against virtualbox blacklisted directories
*/
void vbox_dir()
{
	char szProgramFile[MAX_PATH];
	char szPath[MAX_PATH] = "";
	char szTarget[MAX_PATH] = "oracle\\virtualbox guest additions\\";

	if (IsWoW64())
		ExpandEnvironmentStrings("%ProgramW6432%", szProgramFile, ARRAYSIZE(szProgramFile));
	else
		SHGetSpecialFolderPath(NULL, szProgramFile, CSIDL_PROGRAM_FILES, FALSE);

	PathCombine(szPath, szProgramFile, szTarget);
	if (is_DirectoryExists(szPath))
		exit(1);
}
